# 程序ABI与调用约定

## ABI

### 什么是ABI

应用程序二进制接口（Application Binary Interface， ABI），描述了应用程序和操作系统之间，一个应用和它的库之间，或者应用的组成部分之间的低接口。

### ABI包含什么

* 数据类型的大小、布局和对齐。

* 调用约定
  + 参数传递
  + 返回值地址
  + 平衡堆栈
* 系统调用的编码和如何进行系统调用
* 以及在一个完整的操作系统ABI中，目标文件的二进制格式、程序库等等。

## 调用约定

### 什么是调用约定

函数调用约定，是指当一个函数被调用时，函数的参数会被传递给被调用的函数和返回值会被返回给调用函数。函数的调用约定就是描述参数是怎么传递和由谁平衡堆栈的，当然还有返回值。

### C语言常见调用约定

#### __cdecl

__cdecl是C语言缺省的调用约定，又称为C调用约定。

##### 特点

1. 参数由右向左入栈，放在堆栈中。
2. 主调函数（调用者）负责平衡堆栈，这意味着可以支持不定长参数列表。
3. 函数的返回值保存在eax寄存器中。

#### __stdcall

#### __fastcall

#### __thiscall

#### __nakedcall

#### __vectorcall

